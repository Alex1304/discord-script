
<img align="right" src="https://cdn.discordapp.com/attachments/361255823801974786/594359530209542163/PicsArt_06-29-04.51.14.png" width=18% />

# Discord Script

Configure your Discord server using a powerful, unique, declarative scripting language!

## A... scripting language?? 
Yes! Discord is now a programming language. I'm not joking. But don't worry, I'm gonna explain everything!

## How does it work?  
The whole idea of this project consists of the following: you tell the bot what to do, and it will execute what you requested. For example `create text channel dank-memes`. Simple! And there are as many instructions similar to this one as necessary to configure a full-fledged Discord server! You can write your instructions sequentially in a file to have the configuration of an entire Discord server in a single file and execute everything at once.

## I wanna try that!  
Here's a guide on how to self-host the bot. I'll assume you already created a bot account and grabbed the token.

### Prerequisites
1. The bot is written in Java 11, so you will need to install the Java Development Kit version 11. **It won't work with any version below 11, so double-check your version.**. You need the full JDK as we are going to compile the sources ourselves. 
2. Apache Maven. This is the build tool used to compile the bot. Pick the latest stable version.  
**Make sure to correctly configure your environment variables so that you can run `mvn --version` and `java --version` fine from a terminal.**

### Step 1 
Clone this repository and enter project's root directory
```sh
git clone https://github.com/Alex1304/discord-script.git
cd discord-script
```

### Step 2 
Run this command to compile the bot:
```sh
mvn package
```
This should create a file named `discordscript.jar`, at the root directory.

### Step 3 
You can now launch the bot! 
```
java -jar discordscript.jar YOUR_TOKEN_HERE
```
Great! Now this is where fun begins.

## How to use the bot?  
The first thing you need to do is to create a new Discord server and to add the bot in it. Then, give the bot Administrator permissions, and place its role at the highest possible position in the hierarchy. **Missing permissions are the main cause for failing scripts, so don't neglect that!**. You should also delete the channels and categories generated by default when creating a new Discord server, except for the text channel of course.

The bot doesn't have any commands. To trigger it, you need to @mention the bot account and then either write your instructions after the mention, or attach a file containing the script to execute. Full details on the available instructions are documented below in the section "DiscordScript language specifications", but we will be using only simple ones for now.  
Head over to Discord in the default channel of the server you just created and send the following:

```
@yourbot#0000 create text channel test
```
And boom! A new text channel just spawned in your server! You can add some options to the instructions like:

```
@yourbot#0000 create text channel test2 topic "I did it!!!" nsfw slowmode 120
```
It will create a text channel named "test2" with "I did it!!!" as channel topic, marked as nsfw and with a slowmode of 120 seconds.

Okay now you can delete test and test2, we are going to try something else even bigger! You see the `test.ds` file located in the `samples/` subdirectory of the project? Drag this file into to Discord in the server, add the bot @mention in the message content box and send it.

![Example Usage](https://cdn.discordapp.com/attachments/361255823801974786/594343977969254400/Screenshot_20190629_035024.jpg) 

Observe the magic: an entire Discord server was configured under your eyes, almost instantly! You can open the file to see what was inside, and there you can have an overview of how the DiscordScript language looks like. As you can see, that's pretty intuitive and easy to read! Continue reading below to know the details.

## DiscordScript language specifications

### Comments 
You can add comments to your scripts using a # symbol. It works exactly like in Python, nothing complicated. Everything past the # is considered a comment and is ignored by the bot. 

### Strings 
If you need to specifiy a name or something that contains spaces (for example a channel topic) you must wrap them between double quotes:

```
# The following will work
create text channel test topic "this is a topic" 
# Thr following will also work 
create text channel test topic "this is a topic 
on multiple lines  
yay!"
# The following will NOT work
create text channel test topic this is a topic
```

### Line breaking 
The language offers the possibility to break an instruction into several lines using the pipe (|). Useful if an instruction is very long.

```
# one line instruction 
create category test position 3
# multiline instruction 
create category test
| position 3
```

### Instructions  
As of now the language has 6 instructions. For each one I'm gonna put optional parts into `[` `] `, and custom inputs into `<` `>` they aren't part of the instruction of course. Note that two consecutive optional portions may be arranged in any order (so doing `create text channel test slowmode 120 nsfw` is the same as doing `create text channel test nsfw slowmode 120` for example). **Everything is case insensitive.**

#### Create category 
```
create category <category name> [position <position number>] 
```

Creates a new category. The postion is optional and specific at which position it should be placed in the channel list. 

#### Create text channel 
```
create text channel <channel name> [topic <channel topic>] [category <category name>] [nsfw] [slowmode <seconds>] [postion <postion number>] 
```

Creates a new text channel. You can set the channel topic, the parent category, nsfw state, slowmode, and position in channel list. 

#### Create voice channel 
```
create voice channel <channel name> [category <category name>] [bitrate <bitrate value>] [userlimit <max users>] [postion <postion number>] 
```

Creates a voice channel. You can set the parent category and the position just like text channels, and you can also configure bitrate (in bytes, not kilobytes) and user limit.

#### Create role 
```
create role <role name> [color <color hex code>] 
```

Creates a new role. You can set a color to it with the hex code. Note that you need to wrap the hex code in double quotes in order to use the format with #, otherwise it will be mistaken as a comment!

```
create role test color "#00FF33" 
```
Currently you cannot configure hoist state and mentionable state, forgot to add them, sorry!

#### Move role 
```
move role <role name> position <position number>
```

Moves a role in the hierarchy. You can use only values greater or equal than 2, because it can't move a role above the bot's role (obviously).

#### Configure permissions 
```
configure permissions for <role name>
| [on <channel 1> allow|deny <permission 1> <permission 2> ...]
| [on <channel 2> allow|deny <permission 1> <permission 2> ...]
| ...
| default [<permission 1> <permission 2> ...]
```

Configure base permissions and channel overrides for a specific role. Permissions are specified by their name as they are called in Discord API docs, except that they are case insensitive (`view_channel`, `send_messages`, etc). You need to specify at least 1 permission after "allow" or "deny", but you can leave empty after "default" if you don't want a role to have any base permissions.

### Limitations
- Only files with a `.ds` extension are recognized, otherwise, the file is ignored and nothing will happen
- The bot will only respond to the guild owner
- The language contains only instructions to create stuff, not to edit or delete them. It is currently designed to create a new server from scratch, not to rebrand an existing one. 
- The language only support channel/category/role names in instructions. So if two or more channels/categories/roles have the same name, the bot will pick up one at random and the result might not be the one expected.

## License 
MIT 

## Contact 
Discord: Alex1304#9704 

Twitter: [@gd_alex1304](https://twitter.com/gd_alex1304)
